<div class="wrapper wrapper-content">

  <div class="row">
    <div class=" row ibox float-e-margins">
      <div class="ibox-title">
        <h5>Initiate Service</h5>
      </div>
    </div>
  </div>

  <div class="row">

    <div class="ibox">
      <div class="ibox-content">



          <form [formGroup]="myForm" novalidate (ngSubmit)="save(myForm)">
          <div class="form-group row">
            <div class="col-md-6">
              <label>Service Name</label>
              <input type="text" class="form-control" formControlName="serviceName">
              <small *ngIf="!myForm.controls.serviceName.valid" class="text-danger">
                Name is required (minimum 5 characters).
              </small>
            </div>
            <div class="col-md-6">
              <label>Service Description</label>
              <textarea type="text" class="form-control" formControlName="description"></textarea>
              <!--<small *ngIf="!myForm.controls.serviceName.valid" class="text-danger">
                Name is required (minimum 5 characters).
              </small>-->
            </div>
          </div>
          <!--actionFormDtos-->
          <div class="form-group row">
            <div class="col-sm-12">

              <div formArrayName="actionFormDtos">
                <div class="panel-group" id="accordion">
                <div *ngFor="let actions of myForm.controls.actionFormDtos.controls; let i=index" class="panel panel-info">


                      <div class="panel-heading">
                        <h5 class="panel-title">
                          <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne{{i}}"><span>Action {{i + 1}}</span></a>
                          <a class="close-link pull-right" *ngIf="myForm.controls.actionFormDtos.controls.length > 1" (click)="removeActionFormDtos(i)">
                          <i class="fa fa-times"></i>
                          </a>
                        </h5>
                      </div>
                      <div id="collapseOne{{i}}" class="panel-collapse collapse">
                        <div class="panel-body">
                          <div class="panel-body" [formGroupName]="i">

                            <div class="row">
                              <div class="form-group col-xs-6">
                                <label>apiId</label>
                                <input type="text" class="form-control" formControlName="apiId">

                              </div>
                              <div class="form-group col-xs-6">
                                <label>actionDesc</label>
                                <textarea type="text" class="form-control" formControlName="actionDesc"></textarea>
                                <small [hidden]="myForm.controls.actionFormDtos.controls[i].controls.actionDesc.valid" class="text-danger">
                                  actionDesc is required
                                </small>
                              </div>
                            </div>

                            <!--keyWordFromDtos-->
                            <div formArrayName="keyWordFromDtos">

                              <div class="row">
                                <div class="col-sm-12">
                                  <div class="panel-group" id="accordion1">
                                    <div *ngFor="let keyWordSet of actions.controls.keyWordFromDtos.controls; let j=index" class="panel panel-success">

                                      <div class="panel-heading">
                                        <h5 class="panel-title">
                                          <a data-toggle="collapse" data-parent="#accordion1" href="#collapseTwo{{j}}"><span>Key Sets {{j + 1}}</span></a>
                                          <a class="close-link pull-right" *ngIf="actions.controls.keyWordFromDtos.controls.length > 1" (click)="removeKeySet(j)">
                                            <i class="fa fa-times"></i>
                                          </a>
                                        </h5>

                                      </div>

                                      <div id="collapseTwo{{j}}" class="panel-collapse collapse">
                                        <div class="panel-body" [formGroupName]="j">

                                          <div class="row">

                                            <div class="col-md-3">
                                              <div class="row">
                                                <div class="col-md-3"><label>firstKey</label></div>
                                                <div class="col-md-9"><input type="text" class="form-control" formControlName="firstKey"></div>
                                              </div>
                                            </div>
                                            <div class="col-md-3">
                                              <div class="row">
                                                <div class="col-md-3"><label>gegEx</label></div>
                                                <div class="col-md-9"><input type="text" class="form-control" formControlName="regEx"></div>
                                              </div>
                                            </div>
                                            <div class="col-md-3">
                                              <div class="row">
                                                <div class="col-md-5"><label style="float: right">full Match</label></div>
                                                <div class="col-md-7"><input type="checkbox" style="float: left" id="fullMatch" value="1" formControlName="fullMatch" /></div>
                                              </div>
                                            </div>
                                            <div class="col-md-3">
                                              <div class="row">
                                                <div class="col-md-5"><label style="float: right">ignoreCase</label></div>
                                                <div class="col-md-7"><input type="checkbox" style="float: left" id="ignoreCase" value="1" formControlName="ignoreCase" /></div>
                                              </div>
                                            </div>


                                          </div>

                                        </div>
                                      </div>

                                  </div>
                                  </div>
                                  </div>
                              </div>

                              <div class="row" style="margin-top: 20px;">
                                <div class="col-sm-4">
                                  <button type="button" class="btn btn-primary btn-xs" (click)="addVariable()">Add another key set</button>
                                </div>
                              </div>
                            </div>

                          </div>
                        </div>
                      </div>

                </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <div class="col-sm-4">
              <button type="button" class="btn btn-primary btn-xs" (click)="addActionFormDtos()">Add another action</button>
            </div>
          </div>

          <div class="margin-20">
            <button type="submit" class="btn btn-primary pull-right" [disabled]="!myForm.valid">Submit</button>
          </div>
          <div class="clearfix"></div>

          <div class="margin-20">
            <div>myForm details:-</div>
            <pre>Is myForm valid?: <br>{{myForm.valid | json}}</pre>
            <pre>form value: <br>{{myForm.value | json}}</pre>
          </div>
        </form>



      </div>

    </div>

  </div>

</div>


